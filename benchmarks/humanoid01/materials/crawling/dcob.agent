// agent file for motion learning task of manoi01

//TODO include crawling-disca.agent

//NOTE ngnet should be defined as a MBasisFunctionsDCOBNGnet

module MActionSetDCOB                                             , dcob
module MBFTrans                                                   , bftrans
module MLinearFunctionRv                                          , Cp
module MLinearFunctionRv                                          , Cd


/// initialization process:
connect  ngnet.slot_initialize_finished                 , avf_linear.slot_initialize
connect  lmanager.signal_initialization                 , bftrans.slot_initialize

/// start of episode process:

/// start of time step process:
connect  timer.signal_start_of_step_ud1                 , bftrans.slot_start_time_step

/// end of time step process:
connect  timer.signal_end_of_step_ud1                   , bftrans.slot_finish_time_step

/// learning signals:
connect  behavior.signal_execute_action                 , dcob.slot_execute_action
connect  dcob.signal_execute_command                    , bftrans.slot_execute_action
connect  bftrans.slot_execute_action_finished           , holder_action.slot_1

// for crawling/cmn.agent:
connect  bftrans.signal_execute_command                 , environment.slot_execute_command_des_q
// for crawling/cmn2.agent:
// connect  bftrans.signal_execute_command                 , action_converter.slot_x
// connect  action_converter.signal_y                      , environment.slot_execute_command_des_q

connect  bftrans.signal_end_of_action                   , behavior.slot_finish_action


/// I/O:
connect  dcob.out_action_set_size                       , avf_linear.in_action_set_size
connect  tr_ngnet.out_y                                 , bftrans.in_feature
connect  tr_state.out_x                                 , bftrans.in_state
connect  ngnet.out_distance_to_nearest_bf               , bftrans.in_distance_to_nearest_bf
connect  Cp.out_f2                                      , bftrans.in_extract_proportional
connect  Cd.out_f2                                      , bftrans.in_extract_derivative
connect  ngnet.out_center_state_set                     , dcob.in_center_state_set


/// parameter setting:

dcob.config ={
    IntervalSet = (0.075, 0.1, 0.2)
  }

bftrans.config ={
    ProportionalDim = 5
  }
// for old dcob
// bftrans.config ={
    // AbbreviateTrajectory    = false
    // TrajectoryGeneratorType = tgtJerkMin
    // ZeroUnspecifiedState    = false
  // }

Cp.config ={
    Factor ={
        resize(5, 21)
        [0]= (0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
        [1]= (0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
        [2]= (0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
        [3]= (0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
        [4]= (0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
      }
  }
Cd.config ={
    Factor ={
        resize(5, 21)
        [0]= (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0)
        [1]= (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0)
        [2]= (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0)
        [3]= (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0)
        [4]= (0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1)
      }
  }


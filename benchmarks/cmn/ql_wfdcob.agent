// Q(lambda)-learning modules for continuous action space
// Using wire fitting DCOB and generic TD learner
// The modules include action space
// NOTE:  out_extract_proportional should be connected to MBasisFunctionsDCOBNGnet-ngnet.in_extract_proportional

include_once "wfdcob"

composite MTDWFDCOB
{
  module  MAVFWireFittingDCOB  avf_wire_fitting

  include "ql_cmn_wf"

  module   MRemoveSignalArguments_TRealVector  signal_start_of_action
  connect  behavior.signal_execute_action ,  signal_start_of_action.slot_in
  export   signal_start_of_action.signal_out  as  signal_start_of_action

  module  MWFDCOB  wfdcob

  module  MMediator0_TRealVector in_distance_to_nearest_bf
  export  in_distance_to_nearest_bf.in_1  as  in_distance_to_nearest_bf

  /// initialization process:
  connect  rl_slot_initialize.signal_out           , wfdcob.slot_initialize
  /// start of time step process:
  export   wfdcob.slot_start_time_step  as_is
  /// end of time step process:
  export   wfdcob.slot_finish_time_step  as_is

  /// learning signals:
  connect  behavior.signal_execute_action          , wfdcob.slot_execute_action
  export   wfdcob.signal_execute_command  as_is
  connect  wfdcob.signal_end_of_action             , behavior.slot_finish_action

  /// I/O:
  connect  rl_in_feature.out_1                     , wfdcob.in_feature
  export   wfdcob.in_state  as_is
  connect  in_distance_to_nearest_bf.out_1         , wfdcob.in_distance_to_nearest_bf
  connect  in_distance_to_nearest_bf.out_1         , avf_wire_fitting.in_distance_to_nearest_bf
  export   avf_wire_fitting.in_center_state_set  as_is
  export   wfdcob.out_extract_proportional  as_is

  export avf_wire_fitting.config.DConstraintKind  as_is
  export avf_wire_fitting.config.Interval2Set     as_is

  export wfdcob.config.AbbreviateTrajectory     as_is
  export wfdcob.config.ProportionalDim          as_is
  export wfdcob.config.TrajectoryGeneratorType  as_is
  export wfdcob.config.ZeroUnspecifiedState     as_is
  export wfdcob.config.Cp                       as_is
  export wfdcob.config.Cd                       as_is
}
